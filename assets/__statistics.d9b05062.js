import{_ as I}from"./MainButton.vue_vue_type_script_setup_true_lang.c9e59a40.js";import{_ as E}from"./Card.vue_vue_type_script_setup_true_lang.b14e854b.js";import{_ as M}from"./NumberGroupInput.vue_vue_type_script_setup_true_lang.6d40de97.js";import{u as O}from"./jackpot.d42d8f5f.js";import{P as V}from"./PowerBall__factory.a972b225.js";import{c as A}from"./networks.9d63c03e.js";import{E as U}from"./ethers.08671b99.js";import{_ as F}from"./Modal.vue_vue_type_script_setup_true_lang.7c8b110d.js";import{_ as T}from"./NumberGroup.vue_vue_type_script_setup_true_lang.6515335c.js";import{c as W,s as G}from"./api.e478c08c.js";import{v as C,h as l,z as j,A as y,k as t,E as g,j as p,P as D,F as N,N as S,V as J,r as k,C as L,f as z,J as x,u as m,K as P}from"./index.bc39844c.js";import{u as q}from"./jackpot.49915412.js";import"./OutlineButton.vue_vue_type_script_setup_true_lang.ea89cefd.js";import"./numbers.03942671.js";import"./ethers.0cd5324d.js";import"./IconButton.vue_vue_type_script_setup_true_lang.8635d4de.js";import"./pinia.98a3f9b4.js";import"./provider.db0932ca.js";import"./wallet.17284c08.js";import"./index.f4be9492.js";import"./index.46b289ad.js";import"./error.551bd5c0.js";import"./wallet.b29e5d51.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./loading.d775a9f8.js";const h=V.connect(A.contracts.lottery,U.batchRpcProvider);async function K(d){const[s,a]=await h.getDrawing(d);return{date:s.mul(1e3).toNumber(),block:a.toNumber(),max:(await h.maxPrizes()).toNumber()}}async function R(d,s,a=5e3){const i=[],n=await h.provider.getBlockNumber();for(let o=s;o<=n;o+=a){const _=await h.queryFilter(h.filters.TicketPrinted(d.toString()),o,Math.min(o+a-1,n));i.push(..._.map(b=>b.args._numbers.map(c=>c.toNumber())))}return i}const H=["onSubmit"],Q={class:"flex flex-col items-start space-y-4"},X=t("label",{class:"text-sm font-medium"},"Winning Numbers",-1),Y={class:"flex flex-col items-start space-y-4"},Z=t("label",{class:"text-sm font-medium"},"Prizes Count",-1),tt={class:"flex flex-col items-start space-y-2"},et={class:"flex flex-col items-start space-y-1"},st=t("label",{class:"text-sm font-medium"},"Numbers Match",-1),nt=["value"],at={class:"flex flex-col items-start space-y-1"},rt=t("label",{class:"text-sm font-medium"},"Winners",-1),ot=["value"],lt={class:"flex items-center justify-center"},it=C({__name:"UpdateDrawingModal",props:{id:null,numbers:null,prizes:null},setup(d){const s=d;function a(i){const n=new FormData(i.target),o=n.getAll("winners[]"),_=Object.fromEntries(n.getAll("prizes[]").map((b,c)=>[b,Number.parseInt(o[c].toString())]));W(async()=>{await G(q,s.id,s.numbers,_).then(()=>window.location.reload())})}return(i,n)=>{const o=T,_=I,b=F;return l(),j(b,{title:`Update drawing #${d.id}`},{default:y(()=>[t("form",{class:"space-y-6",onSubmit:J(a,["prevent"])},[t("div",Q,[X,g(o,{numbers:d.numbers},null,8,["numbers"])]),t("div",Y,[Z,t("ul",tt,[(l(!0),p(N,null,D(d.prizes,(c,$)=>(l(),p("li",{key:$,class:"flex items-center space-x-4"},[t("div",et,[st,t("input",{value:$,class:"bg-gray-100 px-4 py-2 text-center",name:"prizes[]",type:"number"},null,8,nt)]),t("div",at,[rt,t("input",{value:c,class:"bg-gray-100 px-4 py-2 text-center",name:"winners[]",type:"number"},null,8,ot)])]))),128))])]),t("div",lt,[g(_,{type:"submit"},{default:y(()=>[S("Submit")]),_:1})])],40,H)]),_:1},8,["title"])}}}),ct={class:"space-y-6"},ut={class:"flex items-center justify-between"},mt={class:"font-bold"},dt={class:"w-full overflow-x-auto"},ft={class:"border-gray-300min-w-full divide-y divide-gray-300 border text-center"},pt={class:"bg-gray-50"},_t={class:"all:py-3 all:px-4 all:font-semibold"},bt={class:"all:whitespace-nowrap all:px-4 all:py-3 all:font-medium"},yt={class:"w-full overflow-x-auto"},gt={class:"min-w-full divide-y divide-gray-300 border border-gray-300 text-center"},vt=t("thead",{class:"bg-gray-50"},[t("tr",{class:"all:py-3 all:px-4 all:font-semibold"},[t("th",null,"Prize"),t("th",null,"Winners")])],-1),wt={class:"flex items-center justify-center"},qt=C({__name:"__statistics",setup(d){const s=O(),a=k(),i=k([]),n=k(),o=k(!1);L(async()=>{!s.nextDrawingId||(a.value=await K(s.nextDrawingId),i.value=await R(s.nextDrawingId,a.value.block))});const _=z(()=>{const r=Object.fromEntries([...Array.from({length:69}).keys()].map(e=>[e+1,0]));if(i.value.length===0)return r;for(const e of i.value)for(const f of e)r[f]++;return r});function b(r,e){let f=0;for(const v of e)r.includes(v)&&f++;return f}const c=z(()=>{if(!a.value)return{};const r=Object.fromEntries([...new Array(a.value.max).keys()].map(e=>[e+1,0]));if(!n.value||i.value.length===0)return r;for(const e of i.value){const f=Math.min(b(n.value,e),a.value.max);f<=0||r[f]++}return r}),$=z(()=>{var r;return!(!s.nextDrawingId||!((r=n.value)!=null&&r.length)||Object.keys(c.value).length===0)});return(r,e)=>{const f=M,v=E,B=I;return l(),p("div",ct,[g(v,null,{default:y(()=>{var u;return[t("div",ut,[t("span",mt," Current Drawing: "+x(`#${m(s).nextDrawingId} - ${new Date(((u=a.value)==null?void 0:u.date)||0).toLocaleDateString()}`),1),g(f,{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=w=>n.value=w),"with-ball":!1},null,8,["modelValue"])])]}),_:1}),g(v,{title:"Occurrences"},{default:y(()=>[t("div",dt,[t("table",ft,[t("thead",pt,[t("tr",_t,[(l(!0),p(N,null,D(Object.keys(m(_)),u=>(l(),p("th",{key:u},x(u),1))),128))])]),t("tbody",null,[t("tr",bt,[(l(!0),p(N,null,D(Object.values(m(_)),(u,w)=>(l(),p("td",{key:w},x(u),1))),128))])])])])]),_:1}),Object.keys(m(c)).length>0?(l(),j(v,{key:0,title:"Prizes"},{default:y(()=>[t("div",yt,[t("table",gt,[vt,t("tbody",null,[(l(!0),p(N,null,D(m(c),(u,w)=>(l(),p("tr",{key:w,class:"all:whitespace-nowrap all:px-4 all:py-3 all:font-medium"},[t("td",null,x(w),1),t("td",null,x(u),1)]))),128))])])])]),_:1})):P("",!0),g(v,null,{default:y(()=>[t("div",wt,[g(B,{disabled:!m($),onClick:e[1]||(e[1]=u=>o.value=!0)},{default:y(()=>[S("Update Drawing")]),_:1},8,["disabled"])])]),_:1}),m(s).nextDrawingId&&n.value&&m(c)?(l(),j(it,{key:1,id:m(s).nextDrawingId,numbers:n.value,prizes:m(c),visible:o.value,onClose:e[2]||(e[2]=u=>o.value=!1)},null,8,["id","numbers","prizes","visible"])):P("",!0)])}}});export{qt as default};
